<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>
      Pomelo
    </title>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <meta http-equiv="content-style-type" content="text/css" />
    <meta http-equiv="content-scripte-type" content="text/javascript" />
    <meta name="author" content="netease" />
    <meta name="version" content="1.0" />
    <meta name="keywords" content="pomelo" />
    <link type="text/css" rel="stylesheet" href="css/base.css" />
    <script src="js/lib/build/build.js" type="text/javascript"></script>
    <script type="text/javascript">
      require('boot');
    </script> 
    <script type="text/javascript">
      var pomelo = window.pomelo;
      var host = "127.0.0.1";
      var port = "3010";
      var loginToken = 'f27ba7d415e97c307c0ff5b79f12ec96';
      
      var tripOrderNumber = null;

      function init() {
        pomelo.init({
          host: host,
          port: port,
          log: true
        }, function() {
            console.log('pomelo client 初始化成功')
        });
      }

      function checkLoginToken() {
        pomelo.request("user.userHandler.checkLoginToken", {token: loginToken}, function(data) {
              console.log(data);
          });
      }

      function loginByWeapp() {
        pomelo.request("user.userHandler.loginByWeapp", {code: '001w5vtH1VTnr80BZqsH128gtH1w5vt6', nickName: '这个是昵称', avatarURL: '这个是头像url'}, function(data) {
              console.log(data);
          });
      }

      function create() {
        pomelo.request("trip.tripHandler.create", {token: loginToken}, function(data) {
              console.log(data);
              if (data.data.ordernumber) {
                tripOrderNumber = data.data.ordernumber;
              }
          });
      }

      function end() {
        pomelo.request("trip.tripHandler.end", {}, function(data) {
              console.log(data);
          });
      }
      
      function queryUnfinished() {
        pomelo.request("trip.tripHandler.queryUnfinished", {token: loginToken}, function(data) {
              console.log(data);
              if (data.data.ordernumber) {
                tripOrderNumber = data.data.ordernumber;
              }
          });
      }

      function entryTrippingRoom() {
        pomelo.request("connector.entryHandler.entryTrippingRoom", {token: loginToken, ordernumber: tripOrderNumber}, function(data) {
              console.log(data);
          });
      }

      function entryWatchingRoom() {
        pomelo.request("connector.entryHandler.entryWatchingRoom", {token: loginToken, ordernumber: tripOrderNumber}, function(data) {
              console.log(data);
          });
      }
      
      function uploadLocation() {
        pomelo.request("trip.tripHandler.uploadLocation", {longitude: '经度', latitude: '纬度'}, function(data) {
              console.log(data);
          });
      }

      function tripSOS() {
        pomelo.request("trip.tripHandler.SOS", {}, function(data) {
              console.log(data);
          });
      }

      function getInfo() {
        pomelo.request("trip.tripHandler.getInfo", {token: loginToken, ordernumber: tripOrderNumber}, function(data) {
              console.log(data);
          });
      }

      function getUserInfoInTripRoom() {
        pomelo.request("trip.tripHandler.getUserInfoInTripRoom", {}, function(data) {
              console.log(data);
          });
      }

      function follow() {
        pomelo.request("user.userHandler.follow", {token: loginToken, followid: 2}, function(data) {
              console.log(data);
          });
      }

      function unfollow() {
        pomelo.request("user.userHandler.unfollow", {token: loginToken, followid: 2}, function(data) {
              console.log(data);
          });
      }

    </script>
  </head>
  <body>
    <div class="g-doc">
      <div class="g-banner" style="border:none">
        <div class="logo">
          <div class="img"></div>
        </div>
      </div>
      <div class="g-background">
        <div class="g-content">
          Welcome to Pomelo
        </div>
      </div>
      <div class="g-link">
        Home:
        <a href="https://github.com/NetEase/pomelo">https://github.com/NetEase/pomelo</a>
      </div>
      <div class="g-button">
        <input id="test" type="button" value="Pomelo 初始化" onclick="init()"/>
        <input id="test" type="button" value="检查Token" onclick="checkLoginToken()"/>
        <input id="test" type="button" value="微信小程序登录" onclick="loginByWeapp()"/>
        <input id="test" type="button" value="创建行程" onclick="create()"/>
        <input id="test" type="button" value="结束行程" onclick="end()"/>
        <input id="test" type="button" value="查询未完成行程" onclick="queryUnfinished()"/>
        <input id="test" type="button" value="进入行程房间(房主模式)" onclick="entryTrippingRoom()"/>
        <input id="test" type="button" value="进入行程房间(观察者模式)" onclick="entryWatchingRoom()"/>
        <input id="test" type="button" value="上报当前位置" onclick="uploadLocation()"/>
        <input id="test" type="button" value="行程求救" onclick="tripSOS()"/>
        <input id="test" type="button" value="获取行程信息" onclick="getInfo()"/>
        <input id="test" type="button" value="获取行程房间内用户" onclick="getUserInfoInTripRoom()"/>
        <input id="test" type="button" value="关注房主" onclick="follow()"/>
        <input id="test" type="button" value="取消关注房主" onclick="unfollow()"/>
      </div>
    </div>
    <br>
  </body>
</html>
